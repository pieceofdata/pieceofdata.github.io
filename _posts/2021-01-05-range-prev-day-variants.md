---
title: Покупка на прорыве волатильности с разными параметрами
tags: проверкаидеи
---

[В прошлой заметке рассмотрел идею покупки на прорыве волатильности](https://zenoftrading.github.io/range-prev-day.html). В чем суть:

Покупки. Дожидаемся открытия дня. Откладываем вверх диапазон предыдущего дня и входим на этом уровне. Если в этот день нет такой цены, то не входим и завтра считаем заново. Выход по следующему открытию выше точки входа. Стоп на уровне точки входа минус половина диапазона предыдущего дня. Продажи обратно покупкам.

У этой стратегии есть недостаток. Могут быть гэпы и тогда стратегия нe выходит из сделки очень долго. Есть несколько случаев, когда в сделке статегия находилась больше 100 дней. Я добавил несколько доп условий, чтобы этого избежать:
- Если стоп не попадает в диапазон дня, ставим стоп на уровень хая этого дня и пробуем по нему выйти на следующий день. Для продаж стоп на уровень лоу дня.
- Если через 5 дней так и не вышли, то выходим по открытию.

Общие показатели немного ухудшились, но время нахождения в сделке теперь не больше 5 дней. Вот такой график на акциях сбера. Напомню, что учитывал комиссю в 0,05% в одну сторону. То есть на круг 0,1%.

![](/assets/images/2021/01/range_prev_day_buy_100.png)\
Только покупки

Стратегия 100_Buy_Trades_Fees
- Возврат стратегии 252%
- Среднегодовой возврат 8%
- Количество сделок 336
- Прибыльных сделок 65%
- Средняя сделка 0.75%
- Самая прибыльная сделка 7%
- Самая убыточная сделка -9%
- Максимальная просадка -11%
- Профит фактор 1.61
- Коэффициент Шарпа 0.998

![](/assets/images/2021/01/range_prev_day_sell_100.png)\
Только продажи

Стратегия 100_Sell_Trades_Fees
- Возврат стратегии 111%
- Среднегодовой возврат 1%
- Количество сделок 343
- Прибыльных сделок 54%
- Средняя сделка 0.32%
- Самая прибыльная сделка 16%
- Самая убыточная сделка -20%
- Максимальная просадка -29%
- Профит фактор 1.04
- Коэффициент Шарпа 0.0716

А теперь подумаем, как можно улучшить стратегию. Например, что будет если брать не 100% от диапазона предыдущего дня, а 50%? Или 150%? Я посчитал варианты от 20% до 190% с шагом в 10%. Посмотрим на параметры для покупок:

![](/assets/images/2021/01/range_prev_day_buy_20_190.png)\
Только покупки с диапазоном от 20% до 190% от предыдущего дня

Видно, что общая и среднегодовая доходность вариантов 80% и 100% от диапазона предыдущего дня почти равны. А вот максимальная просадка -25% против -10%. Если смотреть на осальные параметры вариант со 100% от диапазона предыдущего дня самый выигрышный.

А что с продажами?

![](/assets/images/2021/01/range_prev_day_sell_20_190.png)\
Только продажи с диапазоном от 20% до 190% от предыдущего дня

По графикам видно, что если брать не 100%, а 110% от предыдущего дня, то можно существенно улучшить все показатели. Давайте сравним графики только этих двух вариантов. 

![](/assets/images/2021/01/range_prev_day_sell_100_110.png)\
Только продажи, варианты 100% (синий) и 110% (желтый) от диапазона предыдущего дня

Стратегия 110_Sell_Trades_Fees
- Возврат стратегии 166%
- Среднегодовой возврат 5%
- Количество сделок 284
- Прибыльных сделок 55%
- Средняя сделка 0.58%
- Самая прибыльная сделка 16%
- Самая убыточная сделка -10%
- Максимальная просадка -14%
- Профит фактор 1.33
- Коэффициент Шарпа 0.5

Вот так чуть подкрутив один параметр, можно значительно улучшить стратегию. В следующий раз всё таки посмотрю как эта стратегия работает на разных классах активов.

Бектестер на питоне можно посмотреть в телеграме [https://t.me/zenoftrading](https://t.me/zenoftrading)