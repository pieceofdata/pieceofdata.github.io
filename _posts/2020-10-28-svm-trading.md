---
title: Трейдинг и машинное обучение (svm)
tags: машинноеобучение, svm
---

Недавно посоветовали прочитать [статью про применение SVM к торговле акциями](http://cs229.stanford.edu/proj2009/KingVandrotWeng.pdf). Если перевести дословно название статьи: SVM подход к торговле акциями. SVM это support vector machine один из алгоритмов обучения, на русском звучит как метод опорных векторов. Далее краткий пересказ статьи и в конце мои мысли по ней.

Что они сделали. Взяли часть акций из SP500, которые относятся к нефти. Определили параметры, у которых есть связь с ценой (в порядке значимости):

- Historical Price
- Trading Volume 
- Historical Oil Prices 
- P/E Ratio 
- Enterprise Value / EBITDA
- Current Assets / Current Liabilities
- Total Assets / Total Liabilities
- Percentage of Analysts Recommending Buy and Sell
- Investing Cash Flow / Depreciation
- Market Capitalization / Operating Cash Flow
- Market Capitalization / Revenue
- Operating Cash Flow / Revenue
- Net Increase (Decrease) Cash / Revenue

У них были дневные данные с января 2001 по ноябрь 2009 года (статья 2009 года). Брали данные за 5 дней и пытались предсказать, что будет в следующий день. Первые 6 лет взяли для тренировки алгоритма и последующие 3 года для теста.

Для каждой акции брали разное количество параметров: 1, 5 и 14.

Они использовали не акции сами по себе и торговлю только в рамках одной акции, а рассматривали сектор целиком. Искали кто лучше растёт по сектору и покупали в надежде, что те вырастут ещё сильнее и наоборот, продавали тех, кто падает сильнее остальных в надежде, что те упадут ещё сильнее.

В итоге вот такая точность у них получилась:
![SVM](/assets/images/2020/10/table_svm.png)
Почти всегда чуть больше 50%. Причём пишут, что больше 9 парметров не имеет смысл брать, так как точность не растёт, но производительность падает (думаю сейчас про производительность уже не актуально).

Вроде бы всё хорошо, но потом они показывают занятные графики. По горизонтали дни, по вертикали изменение депозита в процентах.

![SVM 1 feture](/assets/images/2020/10/svm_1feature.png)
Эквити, 1 параметр

![SVM 5 fetures](/assets/images/2020/10/svm_5features.png)
Эквити, 5 параметров

![SVM 14 feture](/assets/images/2020/10/svm_14features.png)
Эквити, 14 параметров

Где видно, что с одним параметром эквити порядка +30% к концу графика и есть тренд вверх, а с 5 и 14 параметрами эквити в минусе и тренд вниз. При этом говорят, что первый график обманчивый, так как недостаточная сила предсказания всего по одному параметру.

# Мысли по статье
1. В статье вообще ничего нет про депозит, где ставят стоп и ставят ли вообще, где выходят из позиции. Повторить точно так же не получится.
2. Авторы делают вывод, что с одним параметром (я так понял ценой) вроде динамика положительная, но всё это херня, так как предсказательная сила мала. Но можно посмотреть и с другой стороны, что цена является самым сильным фактором, от которого зависит цена в будущем. А остальное только мешается.
3. Интересно рассматривать актив в связке со всем сектором. Для Российского рынка мне кажется так себе идея, потому что ликвидность есть у совсем маленького количества инструментов.